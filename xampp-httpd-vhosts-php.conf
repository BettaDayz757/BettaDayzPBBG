# Apache Virtual Hosts for PHP/MySQL Dual-Domain Setup
# Location: d:\bettadayzweb\xampp\apache\conf\extra\httpd-vhosts.conf
#
# This configuration is for traditional PHP/MySQL development
# Use this if you're building with PHP instead of Next.js
#
# Instructions:
# 1. Create folders in htdocs:
#    - htdocs/bettadayz-store  (game domain)
#    - htdocs/bettadayz-shop   (branding domain)
# 2. Copy this file to: d:\bettadayzweb\xampp\apache\conf\extra\httpd-vhosts.conf
# 3. Edit d:\bettadayzweb\xampp\apache\conf\httpd.conf and uncomment:
#    Include conf/extra/httpd-vhosts.conf
# 4. Edit C:\Windows\System32\drivers\etc\hosts and add:
#    127.0.0.1  bettadayz.store
#    127.0.0.1  bettadayz.shop
# 5. Restart Apache in XAMPP Control Panel

##
# Virtual Hosts Configuration for PHP/MySQL
##

# Default localhost virtual host
<VirtualHost *:80>
    ServerName localhost
    DocumentRoot "d:/bettadayzweb/xampp/htdocs"
    
    <Directory "d:/bettadayzweb/xampp/htdocs">
        Options Indexes FollowSymLinks Includes ExecCGI
        AllowOverride All
        Require all granted
    </Directory>
</VirtualHost>

# ============================================================================
# GAME DOMAIN: bettadayz.store (PHP/MySQL)
# ============================================================================

<VirtualHost *:80>
    ServerName bettadayz.store
    ServerAlias www.bettadayz.store
    ServerAdmin admin@bettadayz.store
    
    # Document root for game files
    DocumentRoot "d:/bettadayzweb/xampp/htdocs/bettadayz-store"
    
    <Directory "d:/bettadayzweb/xampp/htdocs/bettadayz-store">
        # Disable directory listing for security
        Options -Indexes +FollowSymLinks +ExecCGI
        
        # Allow .htaccess overrides
        AllowOverride All
        
        # Allow access
        Require all granted
        
        # Default index files
        DirectoryIndex index.php index.html index.htm
        
        # PHP error handling
        php_flag display_errors On
        php_flag log_errors On
        php_value error_log "logs/bettadayz-store-php-errors.log"
        
        # PHP settings for game
        php_value upload_max_filesize 10M
        php_value post_max_size 10M
        php_value max_execution_time 300
        php_value max_input_time 300
        php_value memory_limit 256M
        php_value session.gc_maxlifetime 3600
        
        # Enable URL rewriting for clean URLs
        <IfModule mod_rewrite.c>
            RewriteEngine On
            RewriteBase /
            
            # Remove www
            RewriteCond %{HTTP_HOST} ^www\.bettadayz\.store [NC]
            RewriteRule ^(.*)$ http://bettadayz.store/$1 [R=301,L]
            
            # API routes
            RewriteRule ^api/(.*)$ api/index.php?route=$1 [L,QSA]
            
            # Game routes
            RewriteCond %{REQUEST_FILENAME} !-f
            RewriteCond %{REQUEST_FILENAME} !-d
            RewriteRule ^(.*)$ index.php?route=$1 [L,QSA]
        </IfModule>
    </Directory>
    
    # Protect sensitive files
    <FilesMatch "^\.">
        Require all denied
    </FilesMatch>
    
    <FilesMatch "(config\.php|\.sql|\.env)$">
        Require all denied
    </FilesMatch>
    
    # Logging
    ErrorLog "logs/bettadayz-store-error.log"
    CustomLog "logs/bettadayz-store-access.log" combined
    
    # Security headers
    Header always set X-Frame-Options "DENY"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    
    # CORS for dual domain support
    Header always set Access-Control-Allow-Origin "http://bettadayz.store, http://bettadayz.shop"
    Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
    Header always set Access-Control-Allow-Credentials "true"
</VirtualHost>

# ============================================================================
# BRANDING DOMAIN: bettadayz.shop (PHP/MySQL)
# ============================================================================

<VirtualHost *:80>
    ServerName bettadayz.shop
    ServerAlias www.bettadayz.shop
    ServerAdmin admin@bettadayz.shop
    
    # Document root for branding/shop files
    DocumentRoot "d:/bettadayzweb/xampp/htdocs/bettadayz-shop"
    
    <Directory "d:/bettadayzweb/xampp/htdocs/bettadayz-shop">
        # Disable directory listing for security
        Options -Indexes +FollowSymLinks +ExecCGI
        
        # Allow .htaccess overrides
        AllowOverride All
        
        # Allow access
        Require all granted
        
        # Default index files
        DirectoryIndex index.php index.html index.htm
        
        # PHP error handling
        php_flag display_errors On
        php_flag log_errors On
        php_value error_log "logs/bettadayz-shop-php-errors.log"
        
        # PHP settings for branding site
        php_value upload_max_filesize 10M
        php_value post_max_size 10M
        php_value max_execution_time 300
        php_value max_input_time 300
        php_value memory_limit 128M
        php_value session.gc_maxlifetime 1800
        
        # Enable URL rewriting for clean URLs
        <IfModule mod_rewrite.c>
            RewriteEngine On
            RewriteBase /
            
            # Remove www
            RewriteCond %{HTTP_HOST} ^www\.bettadayz\.shop [NC]
            RewriteRule ^(.*)$ http://bettadayz.shop/$1 [R=301,L]
            
            # Clean URLs for pages
            RewriteCond %{REQUEST_FILENAME} !-f
            RewriteCond %{REQUEST_FILENAME} !-d
            RewriteRule ^([^/]+)/?$ index.php?page=$1 [L,QSA]
        </IfModule>
    </Directory>
    
    # Protect sensitive files
    <FilesMatch "^\.">
        Require all denied
    </FilesMatch>
    
    <FilesMatch "(config\.php|\.sql|\.env)$">
        Require all denied
    </FilesMatch>
    
    # Logging
    ErrorLog "logs/bettadayz-shop-error.log"
    CustomLog "logs/bettadayz-shop-access.log" combined
    
    # Security headers
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    
    # CORS for dual domain support
    Header always set Access-Control-Allow-Origin "http://bettadayz.shop, http://bettadayz.store"
    Header always set Access-Control-Allow-Methods "GET, POST, OPTIONS"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
</VirtualHost>

# ============================================================================
# COMPRESSION & CACHING
# ============================================================================

<IfModule mod_deflate.c>
    # Compress HTML, CSS, JavaScript, Text, XML and fonts
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/json
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/vnd.ms-fontobject
    AddOutputFilterByType DEFLATE application/x-font
    AddOutputFilterByType DEFLATE application/x-font-opentype
    AddOutputFilterByType DEFLATE application/x-font-otf
    AddOutputFilterByType DEFLATE application/x-font-truetype
    AddOutputFilterByType DEFLATE application/x-font-ttf
    AddOutputFilterByType DEFLATE application/x-javascript
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE font/opentype
    AddOutputFilterByType DEFLATE font/otf
    AddOutputFilterByType DEFLATE font/ttf
    AddOutputFilterByType DEFLATE image/svg+xml
    AddOutputFilterByType DEFLATE image/x-icon
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/javascript
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/xml
</IfModule>

<IfModule mod_expires.c>
    ExpiresActive On
    
    # Images
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
    ExpiresByType image/x-icon "access plus 1 year"
    
    # CSS and JavaScript
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    
    # Fonts
    ExpiresByType font/ttf "access plus 1 year"
    ExpiresByType font/otf "access plus 1 year"
    ExpiresByType font/woff "access plus 1 year"
    ExpiresByType font/woff2 "access plus 1 year"
    
    # HTML (dynamic content)
    ExpiresByType text/html "access plus 0 seconds"
</IfModule>

# ============================================================================
# SSL/HTTPS CONFIGURATION (Optional - for local development with self-signed cert)
# ============================================================================
# Uncomment and configure if you want to test HTTPS locally

# <VirtualHost *:443>
#     ServerName bettadayz.store
#     DocumentRoot "d:/bettadayzweb/xampp/htdocs/bettadayz-store"
#     
#     SSLEngine on
#     SSLCertificateFile "conf/ssl.crt/server.crt"
#     SSLCertificateKeyFile "conf/ssl.key/server.key"
#     
#     <Directory "d:/bettadayzweb/xampp/htdocs/bettadayz-store">
#         Options -Indexes +FollowSymLinks
#         AllowOverride All
#         Require all granted
#     </Directory>
#     
#     ErrorLog "logs/bettadayz-store-ssl-error.log"
#     CustomLog "logs/bettadayz-store-ssl-access.log" combined
# </VirtualHost>
# 
# <VirtualHost *:443>
#     ServerName bettadayz.shop
#     DocumentRoot "d:/bettadayzweb/xampp/htdocs/bettadayz-shop"
#     
#     SSLEngine on
#     SSLCertificateFile "conf/ssl.crt/server.crt"
#     SSLCertificateKeyFile "conf/ssl.key/server.key"
#     
#     <Directory "d:/bettadayzweb/xampp/htdocs/bettadayz-shop">
#         Options -Indexes +FollowSymLinks
#         AllowOverride All
#         Require all granted
#     </Directory>
#     
#     ErrorLog "logs/bettadayz-shop-ssl-error.log"
#     CustomLog "logs/bettadayz-shop-ssl-access.log" combined
# </VirtualHost>

# ============================================================================
# NOTES
# ============================================================================
#
# 1. This configuration is for PHP/MySQL development
# 2. For Next.js/Node.js proxy setup, use xampp-httpd-vhosts.conf instead
# 3. Ensure these Apache modules are enabled in httpd.conf:
#    - mod_rewrite
#    - mod_headers
#    - mod_expires
#    - mod_deflate
# 4. Restart Apache after any configuration changes
# 5. Check error logs if domains don't work:
#    d:\bettadayzweb\xampp\apache\logs\error.log
# 6. For production deployment, see XAMPP-PHP-MYSQL-GUIDE.md
#
# ============================================================================

# End of Virtual Hosts Configuration
